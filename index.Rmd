---
title: "Statistical Models for Benchmark Comparison"
author: "David Issa Mattos"
date: "`r format(Sys.time(), '%d %B, %Y')`"
site: bookdown::bookdown_site
documentclass: book
bibliography: "references.bib"
biblio-style: apalike
link-citations: yes
output:
  bookdown::gitbook: default

---

```{r echo=F, eval=T}
library(knitr)
library(rmdformats)
library(kableExtra)
#data processing
library(tidyverse)
library(glue)
#modeling
library(rstan)
options(mc.cores = parallel::detectCores()) #use multiple cores
rstan_options(auto_write = TRUE) # we dont need to recompile
library(coda)
#plotting
library(patchwork)
library(viridis)
library(ggthemr)#devtools::install_github('cttobin/ggthemr')
ggthemr('flat')
ggplot2::theme_replace(axis.title.y=element_blank())
ggplot2::theme_replace(axis.text.y=element_text(size=8))

knitr::opts_chunk$set(
  echo=T, 
  warning=FALSE, 
  include=T,
  cache=F,
  prompt=FALSE,
  tidy=TRUE,
  comment=NA,
  message=FALSE,
  fig.align='center')
knitr::opts_knit$set(width=75)

source("utils.R")
```


# Preface {-}

This document is an online appendix to the paper *"Statistical Models for Benchmark Comparison"* by David Issa Mattos, Jan Bosch and Helena Holmstr√∂m Olsson. It shows the process to analyze the data, including data preparation, modeling and plotting for all the models described on the paper. 


## Pre-requisites {-}

We assume that the reader has some familiarity with the R environment including packages included of the `tidyverse`, such as `dplyr` and `ggplot2`. The code presented is described and fairly commented to help readers follow the modeling process. Other programming languages such as Python with `numpy`, `pandas`, `matplotlib` etc are capable of performing the same steps, but this is out of the scope of this document. For the Bayesian models, we try to minimize dependency on a specific R package such as `brms` or `rstanarm`, and therefore we discuss the model in Stan only, since it has bindings for multiple programming languages. 

## Source code {-}

The full source code is available in the repository.

* The raw data for each model (after the described data transformation) is also available for download in the `./data` folder.
* The Stan models are available in the `./stanmodels` folder.
* The `utils` folder contains some helper functions to help plotting, and generating figures etc... In the chapter *utils* we discuss each function in detail 


The environment was defined and based on the `renv` package. The `renv` package logs all the packages in the `renv.lock` file and manages installation for a specific project. For more information see !!!!!!!
To replicate this environment, after downloading this repository, type:

```{r, eval=F, echo=T}
renv::hydrate()
```

This command will download and install all the the packages use in this work. Note that it will install the packages only for this project. 


## Compiling this document {-}

This document was created with the `bookdown` package. To compile it (and run every command to generate the models, figures and etc. ) type:

```{r eval=F}
rmarkdown::render_site('./index.Rmd',  encoding = 'UTF-8');
```

## Software environment {-}

We suggest to use Stan installed in Linux. There appear to be several problems with Stan in Mac Os Catalina.
The environment used is defined in the `renv.lock` file and session information used to compile this document is 

```{r}
sessionInfo()
```

